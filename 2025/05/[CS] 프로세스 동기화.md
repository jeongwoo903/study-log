# [CS] 프로세스 동기화

## 동기와 비동기

동기와 비동기는 wait(기다림)과 큰 연관이 있다.

- 동기: 일이 끝날때 까지 기다려서 처리하는 것.
- 비동기: 일이 끝날때 까지 기다리지 않고 처리하는 것.

## 프로세스 동기화

> 프로세스가 공유 자원을 사용하려고 할때 동시에 접근하면 문제가 발생할 수 있다.  
> 프로세스 동기화는 한 프로세스가 작업이 끝날때 까지 기다려 병렬 처리를 가능하게 하는 것이다.

프로세스 동기화에는 달성되어야 하는 3가지 조건이 있다.

1. 상호 배제 (Mutual Exclusion)
2. 진행 (Progress)
3. 한정된 대기 (Bounded Waiting)

이 세 가지 조건은 모두 충족되어야 경쟁 상태를 효과적으로 방지할 수 있다.  
위에서 부터 순서대로 중요하다고 볼 수 있다.

### 상호 배제

프로세스 A가 임계 구역에 들어갔을때, 다른 프로세스들은 영역에 못들어가게 하는것.

> **임계 구역(Critical Section)**: 공유 자원 접근 순서에 따라 실행 결과가 달라지는 프로그램의 코드 영역

### 진행

계속해서 어떤 프로세스가 임계구역에 들어갈지 정의하는 과정.

### 한정된 대기

임계구역에 들어가지 못한 프로세스들이 마냥 기다리기만 하면 기아(starvation) 현상이 발생하게 됨.  
그렇기에 한정된 대기횟수 안에 무조건 진입을 해줘야됨.

즉, 각 프로세스는 임계 구역에 들어가기 위해 기다리는 시간이 유한해야 한다는 것.

## 스핀락(Spin Lock)

> 만일 다른 프로세스가 임계 구역 (lock) 사용 시, 무한한 루프를 돌며 임계 구역의 반환을 기다리는 형태

프로세스가 임계 구역 안에 들어가면 그 구역안에 들어오지 못하도록 Lock을 걸어버림.

while문의 반복을 통해서 지속적으로 lock이 해제되었는지 확인하는 형태.

> 스핀락의 특징은 다음과 같다.
>
> - context switching을 하지 않고 진입을 시도하는 형태
> - Busy Waiting 상태 (기다리는 주제에 while을 통해 계속 확인해야 하니까 쓸데없이 cpu를 잡아먹음.)
> - 임계 구역의 실행 시간이 매우 짧은 경우 유용
> - 임계 구역의 실행 시간이 길 경우 CPU 시간을 많이 소모하게 됨

## 동기화 방식 2가지

1. 뮤텍스(Mutex)
2. 세마포어(Semaphore)

뮤텍스는 이진 형태로만 동작을 하지만, 세마포어는 이진형태로도 동작할 수 있지만 많은 프로세스를 감당할 수 있게 설계되었음.  
뮤텍스는 세마포어의 부분집합이다 라고 이해해도 좋음.
