# [JS] 다시 한 번 JS: 실행 컨텍스트

## 실행 컨텍스트 (Execution Context)
실행(Execution): 동일한 조건/환경을 지니는 코드 뭉치
> js에서는 동일한 조건/환경을 지닐수 있는 조건이 4가지 있다.  
> - 전역공간, 함수, eval, module
> 이 중 eval을 제외한 나머지는 **함수**로 요약가능

컨텍스트(Context): 뭔가를 실행할 때 필요한 조건/환경정보.

실행 컨텍스트: 함수를 실행하기 위한 정보를 담은 환경.

if / for / switch / while..과 같은 문들은 별개의 실행 컨텍스트를 생성하지 않음.

## 실행 컨텍스트 동작과 내부

실행 컨텍스트는 함수의 실행 순서에 따라 call stack에 쌓이게 된다.

이런 실행 컨텍스트의 내부는 다음과 같은 형태를 띄고 있다.  

| ![01.png](assets/%5BJS%5D%20%EB%8B%A4%EC%8B%9C%20%ED%95%9C%20%EB%B2%88%20JS%3A%20%EC%8B%A4%ED%96%89%20%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8/01.png) |
|:--------------------------------------------------------------------------------------------------------------------------------------------------:|
|                                                                     실행 컨텍스트 구조                                                                     |

실행 컨텍스트에는 3가지의 정보가 담긴다.
- VariableEnvironment(변수 환경 정보)
  - 식별자의 정보를 수집하는 역할
  - 각 식별자의 값의 변화가 반영되지 않음. 초기 정보만 가짐.
- LexicalEnvironment(어휘적 환경 정보)
  - 각 식별자의 데이터를 추척하는 역할
  - 각 식별자의 값의 변화가 반영됨.
- ThisBinding

### LexicalEnvironment 구조
LexicalEnvironment는 어휘적/사전적 환경이라고 정의 할 수 있다.
이는 사전을 떠올리면 좋은데, `apple -> 사과` 라고 정의 되듯이, `var a -> undefined` 이런식으로 각 식별자의 값을 실시간으로 기억하고 있다.  

| ![02.png](assets/%5BJS%5D%20%EB%8B%A4%EC%8B%9C%20%ED%95%9C%20%EB%B2%88%20JS%3A%20%EC%8B%A4%ED%96%89%20%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8/02.png) |
|:--------------------------------------------------------------------------------------------------------------------------------------------------:|
|                                                              LexicalEnvironment 설명 사진                                                              |

즉, LexicalEnvironment는 **실행 컨텍스트를 구성하는 환경 정보들을 모아 사전처럼 구성한 객체**라고 정의 할 수 있다.

LexicalEnvironment를 구성하는 객체는 다음과 같다.
1. environmentRecord (현재 문맥의 식별자 정보)
2. outerEnvironmentReference (현재 문맥에 관련 있는 외부 식별자 정보)

실행 컨텍스트는 최초 실행될때, environmentRecord에 현재 문맥의 식별자 정보를 수집한다.
현재 컨텍스트가 식별자 정보를 수집해서 environmentRecord에 담는 과정을 **호이스팅**이라고도 한다.

outerEnvironmentReference는 외부 환경에 대한 참조이다.  
즉, 외부의 LexicalEnvironment를 참조하는 것이다.  
outerEnvironmentReference는 현재 LexicalEnvironment에서 변수가 선언되어 있지 않으면 접근 가능한 외부의 LexicalEnvironment를 탐색하는데 이러한 과정을 **Scope Chain** 이라고 한다.

## 정리

| ![03.png](assets/%5BJS%5D%20%EB%8B%A4%EC%8B%9C%20%ED%95%9C%20%EB%B2%88%20JS%3A%20%EC%8B%A4%ED%96%89%20%EC%BB%A8%ED%85%8D%EC%8A%A4%ED%8A%B8/03.png) |
|:--------------------------------------------------------------------------------------------------------------------------------------------------:|
|     정리 |

