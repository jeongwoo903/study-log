# [9장] 커스텀 훅 만들기

## 함수 컴포넌트의 장점
클래스형 컴포넌트에서 분리된 생명주기 매서드 안에 관련 없는 코드를 함께 작성해야 하는 것과 달리, 함수 컴포넌트에 훅을 사용하면 관련된 코드를 한 곳에 모을 수 있다.  

함수 컴포넌트는 클래스형 컴포넌트보다 더 깔끔하고 이해하기 쉽다.  
하지만 긴 함수를 여러 짧은 함수로 분리하는 것과 같은 방식으로, 훅이 수행하는 작업을 컴포넌트 외부에 있는 커스텀 훅으로 추출해서 컴포넌트 콬드를 단순화하고 기능을 재사용할 수 있게 준비할 수 있다.

## 기능을 커스텀 훅으로 추출하기
리액트 훅을 사용하면 
1. 함수 컴포넌트에서 지역 상태를 관리하고 
2. 컨텍스트를 통해 애플리케이션 상태에 접근하며
3. 수명 주기 이벤트에 훅을 걸어서 부수 효과를 수행하고 정리할 수 있다.

아래 그림은 함수 컴포넌트의 핵심기능을 훅으로 추출해 단순화 할 수 있음을 보여준다.

| ![01.jpeg](assets/9%EC%9E%A5/01.jpeg) |
|:-------------------------------------:|
|                함수 단순화                 |

이 뿐만 아니라 여러 컴포넌트에서 훅을 호출해 사용할 수 있다.

> ### 유틸 함수와 리액트 훅의 차이
> 두 경우 모두 코드나 일부 기능을 재사용한다는 면에서 보면 동일하지만, 가장 큰 차이점은 react 내장 훅과 연관이 있는지 없는지가 둘을 분리하는 가장 큰 부분이다.

## 훅 규칙 따르기
훅을 사용하는데 있어서는 몇가지 지켜야할 규칙이 있다.
1. 커스텀 훅의 이름을 'use'로 시작하라
2. 최상위 수준에서만 훅을 호출하라
3. 리액트 함수 안에서만 훅을 호출하라

리액트가 어떤 컴폰너트의 상태를 성공적이고 안정적으로 추적하려면, 해당 컴포넌트에서의 훅 호출 순서나 횟수에 일관성이 있어야 한다.
훅의 세가지 규칙은 훅 호출의 순서가 렌더링마다 변경되지 않도록 보장하기 위해 존재한다.

### 최상위 수준에서만 훅을 호출하기
컴포넌트가 실행될 때마다 일관되게 훅을 호출하는 것이 중요하다.
훅 호출의 일관성을 보장하기 위해 다음 규칙을 따르라.

- 조건문 안에 훅을 넣지 않는다.
- 반복문 안에 훅을 넣지 않는다.
- 중첩된 함수 안에 훅을 넣지 않는다.

위 사항들을 지켜야 하는 이유는 훅 호출을 건너뛰거나 횟수를 변경할 수 있는 시나리오 이기 때문이다.

### 리액트 함수 안에서만 훅을 호출하기
훅이 제공하는 상태는 예측 가능하고 신뢰성이 있어야 한다.  
상태 변경이 예상될 경우 이를 컴포넌트 안에서 볼 수 있어야 하지만, 이런 상태 변경 구현을 커스텀 훅으로 추출할 수 있다.  

컴포넌트가 합리적으로 작동할 수 있도록 돕기 위해 다음 규칙을 지켜야 한다.
- 리액트 함수 컴포넌트에서 훅을 호출하라
- ('use'로 시작하는 이름의) 커스텀 훅에서 훅을 호출하라

## 추가적인 개념

- 훅의 기능과 관련 있는 상태나 효과를 훅 내부에서 관리하고, 컴포넌트에게는 꼭 필요한 값만 반환하라.
```jsx
function useWindowSize()) {
  const [size, setSize] = useState(getSize());
  
  useEffect(() => {/* 효과 수행 */}, []);
  
  return size;
}
```

- 훅에게 필요한 값들을 훅의 파라미터로 전달하라. 훅은 아무것도 반환하지 않거나, 원시 값을 반환하거나, 객체나 배열을 반환할 수 있다. 무엇이든 가장 유용한 것을 반환하라.
```jsx
useDocumentTitle("No return value");
const nextTitle = useRandomTitle(greetings);
const [user, setUser] = useUser();
const {data, status, error} = useFetch();
```